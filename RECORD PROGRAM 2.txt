--2. DML COMMANDS 
------- a) DML -INSERT 
 
 
--1.Insert values in EMPLOYEE table. 

mysql>INSERT INTO EMPLOYEE (SSN, name, city, DOB, adhar_no) VALUES(101, 'KARUN',   'CHENNAI',  '2000-05-12', 844411),(102, 'ABRAHAM', 'KOCHI',    '2000-08-20', 800012),(103, 'JOHN',    'KOCHI',    '2000-01-15', 809012),(104, 'ARUN',    'BANGALORE','2000-11-02', 844442),(105, 'ISAAC',   'BANGALORE','2000-03-30', 802332);
Query OK, 5 rows affected (0.01 sec)
Records: 5  Duplicates: 0  Warnings: 0

mysql> select * from EMPLOYEE;
+------+---------+-----------+------------+----------+
| SSN  | name    | city      | DOB        | adhar_no |
+------+---------+-----------+------------+----------+
|  101 | KARUN   | CHENNAI   | 2000-05-12 |   844411 |
|  102 | ABRAHAM | KOCHI     | 2000-08-20 |   800012 |
|  103 | JOHN    | KOCHI     | 2000-01-15 |   809012 |
|  104 | ARUN    | BANGALORE | 2000-11-02 |   844442 |
|  105 | ISAAC   | BANGALORE | 2000-03-30 |   802332 |
+------+---------+-----------+------------+----------+
5 rows in set (0.00 sec)



--//2. Insert values in STUDENT table. 

mysql> insert into STUDENT(roll_no,name,age,address,gender)values(24,"sidhu",21,"Kerala",'m'),(26,"sreehari",21,"kerala",'m'),(10,"ihsan",21,"kerala",'m'),(4,"amitha",21,"kerala",'f');
Query OK, 4 rows affected (0.01 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> select * from STUDENT;
+---------+----------+------+---------+--------+
| roll_no | name     | age  | address | gender |
+---------+----------+------+---------+--------+
|       4 | amitha   |   21 | kerala  | f      |
|      10 | ihsan    |   21 | kerala  | m      |
|      24 | sidhu    |   21 | Kerala  | m      |
|      26 | sreehari |   21 | kerala  | m      |
+---------+----------+------+---------+--------+
4 rows in set (0.00 sec)



--//3. Insert values in INVOICE database. 


mysql>INSERT INTO Customer (cust_id, name, address, city, ph_no) VALUES
(1, 'Arshad',   'Manzil House', 'Malappuram', 9876543210),
(2, 'Shobith',  'Sreeragam',    'Palakkad',   NULL),
(3, 'Sidhu',    'Green Villa',  'Ernakulam',  9988667755),
(4, 'Mudhasir', 'Palm View',    'Kozhikode',  NULL),
(5, 'Abhishek', 'Hill Crest',   'Thrissur',   9123456789);


mysql> select * from Customer;
+---------+----------+--------------+------------+------------+
| cust_id | name     | address      | city       | ph_no      |
+---------+----------+--------------+------------+------------+
|       1 | Arshad   | Manzil House | Malappuram | 9876543210 |
|       2 | Shobith  | Sreeragam    | Palakkad   | NULL       |
|       3 | Sidhu    | Green Villa  | Ernakulam  | 9988667755 |
|       4 | Mudhasir | Palm View    | Kozhikode  | NULL       |
|       5 | Abhishek | Hill Crest   | Thrissur   | 9123456789 |
+---------+----------+--------------+------------+------------+
5 rows in set (0.00 sec)


mysql> INSERT INTO Product (p_id, p_name, price) VALUES(201, 'Men Shirt', 1999.00),(202, 'Men Jeans', 2499.00),(203, 'Leather Wallet', 1599.00),(204, 'Wrist Watch', 8999.00),(205, 'Formal Shoes', 6999.00);
Query OK, 5 rows affected (0.00 sec)
Records: 5  Duplicates: 0  Warnings: 0

mysql> select * from Product;
+------+----------------+---------+
| p_id | p_name         | price   |
+------+----------------+---------+
|  101 | Pen            |   10.00 |
|  102 | Notebook       |   20.00 |
|  201 | Men Shirt      | 1999.00 |
|  202 | Men Jeans      | 2499.00 |
|  203 | Leather Wallet | 1599.00 |
|  204 | Wrist Watch    | 8999.00 |
|  205 | Formal Shoes   | 6999.00 |
+------+----------------+---------+
7 rows in set (0.00 sec)


mysql> delete from invoice_master where inv_id=1001;
Query OK, 1 row affected (0.00 sec)

mysql> select * from invoice_master;
Empty set (0.00 sec)

mysql> alter table invoice_master modify inv_date DATE;
Query OK, 0 rows affected (0.09 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> insert into invoice_master(inv_id,cust_id,inv_date)values(1001,1,'2025-01-10'),(1002,1,'2025-03-15'),(1003,2,'2025-02-20'),(1004,3,'2025-04-05'),(1005,3,'2025-06-18'),(1006,4,'2025-07-22'),(1007,5,'2025-09-10');
Query OK, 7 rows affected (0.01 sec)
Records: 7  Duplicates: 0  Warnings: 0

mysql> select * from invoice_master;
+--------+---------+------------+
| inv_id | cust_id | inv_date   |
+--------+---------+------------+
|   1001 |       1 | 2025-01-10 |
|   1002 |       1 | 2025-03-15 |
|   1003 |       2 | 2025-02-20 |
|   1004 |       3 | 2025-04-05 |
|   1005 |       3 | 2025-06-18 |
|   1006 |       4 | 2025-07-22 |
|   1007 |       5 | 2025-09-10 |
+--------+---------+------------+
7 rows in set (0.00 sec)


mysql> insert into invoice_item(inv_id,p_id,quantity)values(1001,101,2),(1001,102,1),(1002,201,1),(1003,101,3),(1003,203,1),(1004,202,1),(1004,102,2),(1005,204,1),(1006,205,1),(1007,201,2),(1007,203,1);
Query OK, 11 rows affected (0.01 sec)
Records: 11  Duplicates: 0  Warnings: 0
mysql> select * from invoice_item;
+--------+------+----------+
| inv_id | p_id | quantity |
+--------+------+----------+
|   1001 |  101 |        2 |
|   1001 |  102 |        1 |
|   1002 |  201 |        1 |
|   1003 |  101 |        3 |
|   1003 |  203 |        1 |
|   1004 |  202 |        1 |
|   1004 |  102 |        2 |
|   1005 |  204 |        1 |
|   1006 |  205 |        1 |
|   1007 |  201 |        2 |
|   1007 |  203 |        1 |
+--------+------+----------+
11 rows in set (0.00 sec)



--b) DML - UPDATE 
 --1. Update the price of a particular product. 

mysql> UPDATE Product SET price = 2199.00 WHERE p_id = 201;
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> SELECT * FROM Product WHERE p_id = 201;
+------+-----------+---------+
| p_id | p_name    | price   |
+------+-----------+---------+
|  201 | Men Shirt | 2199.00 |
+------+-----------+---------+
1 row in set (0.00 sec)


--//2. Change the name of city ‘calicut’ to ‘kozhikode’ in the customer table.

mysql> UPDATE Customer SET city = 'Calicut' WHERE city = 'Kozhikode';
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from Customer where city='Calicut';
+---------+----------+-----------+---------+-------+
| cust_id | name     | address   | city    | ph_no |
+---------+----------+-----------+---------+-------+
|       4 | Mudhasir | Palm View | Calicut | NULL  |
+---------+----------+-----------+---------+-------+


--// 3. Update all prices with 2% of its original price. 

mysql> UPDATE Product SET price = price * 1.02;
Query OK, 7 rows affected (0.01 sec)
Rows matched: 7  Changed: 7  Warnings: 0

mysql> select * from Product;
+------+----------------+---------+
| p_id | p_name         | price   |
+------+----------------+---------+
|  101 | Pen            |   10.20 |
|  102 | Notebook       |   20.40 |
|  201 | Men Shirt      | 2242.98 |
|  202 | Men Jeans      | 2548.98 |
|  203 | Leather Wallet | 1630.98 |
|  204 | Wrist Watch    | 9178.98 |
|  205 | Formal Shoes   | 7138.98 |
+------+----------------+---------+
7 rows in set (0.00 sec)


--//4. Change the address, city, phone number of a particular customer. 

mysql> UPDATE Customer SET address = 'New House', city = 'Wayanad', ph_no = 9876501234 WHERE cust_id = 3;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> SELECT * FROM Customer WHERE cust_id = 3;
+---------+-------+-----------+---------+------------+
| cust_id | name  | address   | city    | ph_no      |
+---------+-------+-----------+---------+------------+
|       3 | Sidhu | New House | Wayanad | 9876501234 |
+---------+-------+-----------+---------+------------+
1 row in set (0.00 sec)


--//5. Change the quantity of a purchased product of inv_id ‘101’ 

mysql> UPDATE invoice_item SET quantity = 5 WHERE inv_id = 1001;
Query OK, 2 rows affected (0.01 sec)
Rows matched: 2  Changed: 2  Warnings: 0

mysql> SELECT * FROM invoice_item WHERE inv_id = 1001;
+--------+------+----------+
| inv_id | p_id | quantity |
+--------+------+----------+
|   1001 |  101 |        5 |
|   1001 |  102 |        5 |
+--------+------+----------+
2 rows in set (0.00 sec)


c) DML - DELETE 

--//1. Delete the record of customer id ‘10001’. 

mysql> DELETE FROM invoice_item WHERE inv_id IN 
    -> (SELECT inv_id FROM invoice_master WHERE cust_id = 1);
Query OK, 1 row affected (0.01 sec)


mysql> DELETE FROM invoice_master WHERE cust_id = 1;
Query OK, 2 rows affected (0.00 sec)

mysql> DELETE FROM Customer WHERE cust_id = 1;
Query OK, 1 row affected (0.00 sec)

mysql> select *from Customer where cust_id=1;
Empty set (0.00 sec)


--// 2. Delete all purchase details of items its quantity less than 2. 

mysql> DELETE FROM invoice_item WHERE quantity < 2;
Query OK, 5 rows affected (0.01 sec)

mysql> select * from invoice_item;
+--------+------+----------+
| inv_id | p_id | quantity |
+--------+------+----------+
|   1003 |  101 |        3 |
|   1004 |  102 |        2 |
|   1007 |  201 |        2 |
+--------+------+----------+
3 rows in set (0.00 sec)


--//3. Delete the purchase details of product ‘pen’ in the in_id ‘101’. 

mysql> DELETE FROM invoice_item WHERE inv_id = 101 AND p_id = (SELECT p_id FROM Product WHERE p_name = 'Pen');
Query OK, 0 rows affected (0.00 sec)

mysql> SELECT * FROM invoice_item WHERE inv_id = 101;
Empty set (0.00 sec)


--//4. Delete details of customer who does not have phone number.
 
mysql> DELETE FROM invoice_item WHERE inv_id IN (SELECT inv_id FROM invoice_master WHERE cust_id IN (SELECT cust_id FROM Customer WHERE ph_no IS NULL));
Query OK, 1 row affected (0.01 sec)

mysql> DELETE FROM invoice_master WHERE cust_id IN (SELECT cust_id FROM Customer WHERE ph_no IS NULL);
Query OK, 2 rows affected (0.01 sec)

mysql> DELETE FROM Customer WHERE ph_no IS NULL;
Query OK, 2 rows affected (0.00 sec)

mysql> select * from Customer;
+---------+----------+------------+----------+------------+
| cust_id | name     | address    | city     | ph_no      |
+---------+----------+------------+----------+------------+
|       3 | Sidhu    | New House  | Wayanad  | 9876501234 |
|       5 | Abhishek | Hill Crest | Thrissur | 9123456789 |
+---------+----------+------------+----------+------------+
2 rows in set (0.00 sec)


 --//5. Delete all records from STUDENT table. 
 
 mysql> delete from STUDENT;
Query OK, 4 rows affected (0.00 sec)

mysql> select * from STUDENT;
Empty set (0.00 sec)

 --//6. Delete Invoice details of a particular customer "XYZ".
 
mysql> DELETE FROM invoice_item WHERE inv_id IN (SELECT inv_id FROM invoice_master WHERE cust_id = (SELECT cust_id FROM Customer WHERE name = 'Sidhu'));
Query OK, 1 row affected (0.01 sec)

mysql> select * from invoice_item;
+--------+------+----------+
| inv_id | p_id | quantity |
+--------+------+----------+
|   1007 |  201 |        2 |
+--------+------+----------+


mysql>DELETE FROM invoice_master WHERE cust_id = (SELECT cust_id FROM Customer WHERE name = 'Sidhu');
mysql> DELETE FROM invoice_master WHERE cust_id = (SELECT cust_id FROM Customer WHERE name = 'Sidhu');
Query OK, 2 rows affected (0.01 sec)

mysql> select * from invoice_master;
+--------+---------+------------+
| inv_id | cust_id | inv_date   |
+--------+---------+------------+
|   1007 |       5 | 2025-09-10 |
+--------+---------+------------+
1 row in set (0.01 sec)


--//7. Delete the first two records of INVOICE_ITEM table its purchase quantity is high.
mysql> select * from invoice_item;
+--------+------+----------+
| inv_id | p_id | quantity |
+--------+------+----------+
|   1007 |  201 |        2 |
|   1007 |  201 |        5 |
|   1007 |  201 |        7 |
+--------+------+----------+
3 rows in set (0.00 sec)

mysql> DELETE FROM invoice_item ORDER BY quantity DESC LIMIT 2;
Query OK, 2 rows affected (0.00 sec)

mysql> select * from invoice_item;
+--------+------+----------+
| inv_id | p_id | quantity |
+--------+------+----------+
|   1007 |  201 |        2 |
+--------+------+----------+
1 row in set (0.00 sec)

mysql>DELETE FROM invoice_item ORDER BY quantity DESC LIMIT 2;

 



